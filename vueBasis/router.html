<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端路由 | blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="系统性学习，打造完善的知识体系">
    
    <link rel="preload" href="/interview_blog/assets/css/0.styles.81bffcaa.css" as="style"><link rel="preload" href="/interview_blog/assets/js/app.6e789ca6.js" as="script"><link rel="preload" href="/interview_blog/assets/js/2.aedcd1eb.js" as="script"><link rel="preload" href="/interview_blog/assets/js/42.f229993f.js" as="script"><link rel="prefetch" href="/interview_blog/assets/js/10.235d3cd2.js"><link rel="prefetch" href="/interview_blog/assets/js/11.64c88d1d.js"><link rel="prefetch" href="/interview_blog/assets/js/12.389e02a9.js"><link rel="prefetch" href="/interview_blog/assets/js/13.5fd0b99f.js"><link rel="prefetch" href="/interview_blog/assets/js/14.addbf244.js"><link rel="prefetch" href="/interview_blog/assets/js/15.aaa172ef.js"><link rel="prefetch" href="/interview_blog/assets/js/16.efde6c27.js"><link rel="prefetch" href="/interview_blog/assets/js/17.efe499ad.js"><link rel="prefetch" href="/interview_blog/assets/js/18.b43e2679.js"><link rel="prefetch" href="/interview_blog/assets/js/19.1e7d1f1d.js"><link rel="prefetch" href="/interview_blog/assets/js/20.61100763.js"><link rel="prefetch" href="/interview_blog/assets/js/21.77d90c63.js"><link rel="prefetch" href="/interview_blog/assets/js/22.f398ec5f.js"><link rel="prefetch" href="/interview_blog/assets/js/23.a0ed082a.js"><link rel="prefetch" href="/interview_blog/assets/js/24.a5e14725.js"><link rel="prefetch" href="/interview_blog/assets/js/25.dbe614ed.js"><link rel="prefetch" href="/interview_blog/assets/js/26.f2947465.js"><link rel="prefetch" href="/interview_blog/assets/js/27.ccd771c7.js"><link rel="prefetch" href="/interview_blog/assets/js/28.78bc3610.js"><link rel="prefetch" href="/interview_blog/assets/js/29.ad03d3fc.js"><link rel="prefetch" href="/interview_blog/assets/js/3.b709dd0d.js"><link rel="prefetch" href="/interview_blog/assets/js/30.12e12cb8.js"><link rel="prefetch" href="/interview_blog/assets/js/31.63b1cf5c.js"><link rel="prefetch" href="/interview_blog/assets/js/32.10ace32c.js"><link rel="prefetch" href="/interview_blog/assets/js/33.14d149d9.js"><link rel="prefetch" href="/interview_blog/assets/js/34.b8c73cce.js"><link rel="prefetch" href="/interview_blog/assets/js/35.3e8d4f21.js"><link rel="prefetch" href="/interview_blog/assets/js/36.ed8a1bb7.js"><link rel="prefetch" href="/interview_blog/assets/js/37.ce354d46.js"><link rel="prefetch" href="/interview_blog/assets/js/38.37bcf5ce.js"><link rel="prefetch" href="/interview_blog/assets/js/39.d4956b62.js"><link rel="prefetch" href="/interview_blog/assets/js/4.87406268.js"><link rel="prefetch" href="/interview_blog/assets/js/40.f0ecd4dc.js"><link rel="prefetch" href="/interview_blog/assets/js/41.01c18d9c.js"><link rel="prefetch" href="/interview_blog/assets/js/43.f08935e7.js"><link rel="prefetch" href="/interview_blog/assets/js/44.d134aed1.js"><link rel="prefetch" href="/interview_blog/assets/js/45.dbda6222.js"><link rel="prefetch" href="/interview_blog/assets/js/46.661000b0.js"><link rel="prefetch" href="/interview_blog/assets/js/47.12709f91.js"><link rel="prefetch" href="/interview_blog/assets/js/48.d8e794b9.js"><link rel="prefetch" href="/interview_blog/assets/js/5.c38690e3.js"><link rel="prefetch" href="/interview_blog/assets/js/6.f9104e5b.js"><link rel="prefetch" href="/interview_blog/assets/js/7.397ab168.js"><link rel="prefetch" href="/interview_blog/assets/js/8.3afdacb3.js"><link rel="prefetch" href="/interview_blog/assets/js/9.a12c6f31.js">
    <link rel="stylesheet" href="/interview_blog/assets/css/0.styles.81bffcaa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/interview_blog/" class="home-link router-link-active"><!----> <span class="site-name">blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/interview_blog/" class="nav-link">
  文章目录
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/interview_blog/" class="nav-link">
  文章目录
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/interview_blog/" aria-current="page" class="sidebar-link">JavaScript</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue3 UI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS 基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ajax &amp; jsonp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>函数式编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview_blog/vueBasis/template.html" class="sidebar-link">vue 模板到真实 DOM 渲染的过程</a></li><li><a href="/interview_blog/vueBasis/model.html" class="sidebar-link">双向数据绑定原理</a></li><li><a href="/interview_blog/vueBasis/router.html" aria-current="page" class="active sidebar-link">前端路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#为什么有-hash-和-history" class="sidebar-link">为什么有 hash 和 history</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#hash-vs-history" class="sidebar-link">hash vs history</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#原理" class="sidebar-link">原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#hash-实现" class="sidebar-link">hash 实现</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#history-实现" class="sidebar-link">history 实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#router-方法" class="sidebar-link">router 方法</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#q-a" class="sidebar-link">Q &amp; A</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#有个问题-hash模式-也可以用history-go-back-forward来触发hashchange事件吗" class="sidebar-link">有个问题：hash模式，也可以用history.go,back,forward来触发hashchange事件吗？</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vueBasis/router.html#为什么-history-需要后端配置-nginx" class="sidebar-link">为什么 history 需要后端配置 nginx？</a></li></ul></li></ul></li><li><a href="/interview_blog/vueBasis/asyncComponent.html" class="sidebar-link">/vueBasis/asyncComponent.html</a></li><li><a href="/interview_blog/vueBasis/nextTick.html" class="sidebar-link">NextTick</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SSR</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端路由"><a href="#前端路由" class="header-anchor">#</a> 前端路由</h1> <p>https://juejin.im/post/6844903589123457031#heading-6
https://juejin.im/post/6854573222231605256#heading-9</p> <h2 id="为什么有-hash-和-history"><a href="#为什么有-hash-和-history" class="header-anchor">#</a> 为什么有 hash 和 history</h2> <p>前端路由的核心，就在于 —— <strong>改变视图的同时不会向后端发出请求</strong>。</p> <h2 id="hash-vs-history"><a href="#hash-vs-history" class="header-anchor">#</a> hash vs history</h2> <p>https://juejin.im/post/6844903552519766029</p> <ol><li><p>hash</p> <ul><li><p>它的特点在于：hash 虽然出现在 URL 中，但不会被包括在 HTTP 请求中，对后端完全没有影响，因此改变 hash 不会重新加载页面。</p></li> <li><p>hash的优势就是兼容性更好,在老版IE中都可以运行。</p></li> <li><p>问题在于url中一直存在 <code>#</code> 不够美观,而且hash路由更像是Hack而非标准,
相信随着发展更加标准化的History API会逐步蚕食掉hash路由的市场。</p></li></ul></li> <li><p>history</p> <ul><li><p>利用了 HTML5 History Interface 中新增的 pushState() 和 replaceState() 方法。（需要特定浏览器支持）</p></li> <li><p>这两个方法应用于浏览器的历史记录栈，在当前已有的 back、forward、go 的基础之上，它们提供了对历史记录进行修改的功能。</p></li> <li><p>只是当它们执行修改时，虽然改变了当前的 URL，但浏览器不会立即向后端发送请求。</p></li></ul></li></ol> <h2 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h2> <h3 id="hash-实现"><a href="#hash-实现" class="header-anchor">#</a> hash 实现</h3> <p>hash 是 URL 中 hash (#) 及后面的那部分，常用作锚点在页面内进行导航，<strong>改变 URL 中的 hash 部分不会引起页面刷新</strong></p> <p>通过 <code>hashchange</code> 事件监听 URL 的变化，改变 URL 的方式只有这几种：</p> <ul><li><p>通过浏览器前进后退改变 URL</p></li> <li><p>通过 <code>&lt;a&gt;</code> 标签改变 URL</p></li> <li><p>通过 window.location 改变URL</p></li></ul> <h3 id="history-实现"><a href="#history-实现" class="header-anchor">#</a> history 实现</h3> <p>history 提供了 pushState 和 replaceState 两个方法，<strong>这两个方法改变 URL 的 path 部分不会引起页面刷新</strong></p> <p>history 提供类似 hashchange 事件的 <code>popstate</code> 事件可供监听，但 popstate 事件有些不同：</p> <ul><li><p>通过浏览器前进后退改变 URL 时会触发 <code>popstate</code> 事件</p></li> <li><p>但是，<strong>通过 <code>pushState</code>/<code>replaceState</code>或 <code>&lt;a&gt;</code> 标签改变 URL 不会触发 <code>popstate</code> 事件。</strong></p></li> <li><p><strong>好在我们可以拦截 <code>pushState/replaceState</code> 的调用和 <code>&lt;a&gt;</code> 标签的点击事件来检测 URL 变化</strong></p></li> <li><p>通过 <code>js</code> 调用 <code>history</code> 的 <code>back，go，forward</code> 方法课触发该事件</p></li></ul> <p>所以监听 URL 变化可以实现，只是没有 hashchange 那么方便。</p> <h2 id="router-方法"><a href="#router-方法" class="header-anchor">#</a> router 方法</h2> <p>VueRouter 类中的 onReady(), push() 等方法只是一个代理，
实际是调用的具体 history 对象的对应方法，在 init() 方法中初始化时，也是根据 history 对象具体的类别执行不同操作</p> <h2 id="q-a"><a href="#q-a" class="header-anchor">#</a> Q &amp; A</h2> <h3 id="有个问题-hash模式-也可以用history-go-back-forward来触发hashchange事件吗"><a href="#有个问题-hash模式-也可以用history-go-back-forward来触发hashchange事件吗" class="header-anchor">#</a> 有个问题：hash模式，也可以用history.go,back,forward来触发hashchange事件吗？</h3> <p>A：也是可以的。因为不管什么模式，浏览器为保存记录都会有一个栈。</p> <h3 id="为什么-history-需要后端配置-nginx"><a href="#为什么-history-需要后端配置-nginx" class="header-anchor">#</a> 为什么 history 需要后端配置 nginx？</h3> <p>当然啦，history 也不是样样都好。SPA 虽然在浏览器里游刃有余，但真要通过 URL 向后端发起 HTTP 请求时，两者的差异就来了。</p> <p>尤其在用户手动输入 URL 后回车，或者刷新（重启）浏览器的时候。</p> <ol><li><p><code>hash</code> 模式下，仅 hash 符号之前的内容会被包含在请求中，如 http://www.abc.com，因此对于后端来说，即使没有做到对路由的全覆盖，也不会返回 404 错误。</p></li> <li><p><code>history</code> 模式下，前端的 URL 必须和实际向后端发起请求的 URL 一致，如 http://www.abc.com/book/id。如果后端缺少对 /book/id 的路由处理，将返回 404 错误。</p></li></ol> <p><strong>Vue-Router 官网里如此描述：“不过这种模式要玩好，还需要后台配置支持……所以呢，你要在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。”</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/5/2020, 8:38:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview_blog/vueBasis/model.html" class="prev">
        双向数据绑定原理
      </a></span> <span class="next"><a href="/interview_blog/vueBasis/asyncComponent.html">
        /vueBasis/asyncComponent.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/interview_blog/assets/js/app.6e789ca6.js" defer></script><script src="/interview_blog/assets/js/2.aedcd1eb.js" defer></script><script src="/interview_blog/assets/js/42.f229993f.js" defer></script>
  </body>
</html>
