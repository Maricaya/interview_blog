<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue3 项目介绍 | blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="系统性学习，打造完善的知识体系">
    
    <link rel="preload" href="/interview_blog/assets/css/0.styles.81bffcaa.css" as="style"><link rel="preload" href="/interview_blog/assets/js/app.6e789ca6.js" as="script"><link rel="preload" href="/interview_blog/assets/js/2.aedcd1eb.js" as="script"><link rel="preload" href="/interview_blog/assets/js/10.235d3cd2.js" as="script"><link rel="prefetch" href="/interview_blog/assets/js/11.64c88d1d.js"><link rel="prefetch" href="/interview_blog/assets/js/12.389e02a9.js"><link rel="prefetch" href="/interview_blog/assets/js/13.5fd0b99f.js"><link rel="prefetch" href="/interview_blog/assets/js/14.addbf244.js"><link rel="prefetch" href="/interview_blog/assets/js/15.aaa172ef.js"><link rel="prefetch" href="/interview_blog/assets/js/16.efde6c27.js"><link rel="prefetch" href="/interview_blog/assets/js/17.efe499ad.js"><link rel="prefetch" href="/interview_blog/assets/js/18.b43e2679.js"><link rel="prefetch" href="/interview_blog/assets/js/19.1e7d1f1d.js"><link rel="prefetch" href="/interview_blog/assets/js/20.61100763.js"><link rel="prefetch" href="/interview_blog/assets/js/21.77d90c63.js"><link rel="prefetch" href="/interview_blog/assets/js/22.f398ec5f.js"><link rel="prefetch" href="/interview_blog/assets/js/23.a0ed082a.js"><link rel="prefetch" href="/interview_blog/assets/js/24.a5e14725.js"><link rel="prefetch" href="/interview_blog/assets/js/25.dbe614ed.js"><link rel="prefetch" href="/interview_blog/assets/js/26.f2947465.js"><link rel="prefetch" href="/interview_blog/assets/js/27.ccd771c7.js"><link rel="prefetch" href="/interview_blog/assets/js/28.78bc3610.js"><link rel="prefetch" href="/interview_blog/assets/js/29.ad03d3fc.js"><link rel="prefetch" href="/interview_blog/assets/js/3.b709dd0d.js"><link rel="prefetch" href="/interview_blog/assets/js/30.12e12cb8.js"><link rel="prefetch" href="/interview_blog/assets/js/31.63b1cf5c.js"><link rel="prefetch" href="/interview_blog/assets/js/32.10ace32c.js"><link rel="prefetch" href="/interview_blog/assets/js/33.14d149d9.js"><link rel="prefetch" href="/interview_blog/assets/js/34.b8c73cce.js"><link rel="prefetch" href="/interview_blog/assets/js/35.3e8d4f21.js"><link rel="prefetch" href="/interview_blog/assets/js/36.ed8a1bb7.js"><link rel="prefetch" href="/interview_blog/assets/js/37.ce354d46.js"><link rel="prefetch" href="/interview_blog/assets/js/38.37bcf5ce.js"><link rel="prefetch" href="/interview_blog/assets/js/39.d4956b62.js"><link rel="prefetch" href="/interview_blog/assets/js/4.87406268.js"><link rel="prefetch" href="/interview_blog/assets/js/40.f0ecd4dc.js"><link rel="prefetch" href="/interview_blog/assets/js/41.01c18d9c.js"><link rel="prefetch" href="/interview_blog/assets/js/42.f229993f.js"><link rel="prefetch" href="/interview_blog/assets/js/43.f08935e7.js"><link rel="prefetch" href="/interview_blog/assets/js/44.d134aed1.js"><link rel="prefetch" href="/interview_blog/assets/js/45.dbda6222.js"><link rel="prefetch" href="/interview_blog/assets/js/46.661000b0.js"><link rel="prefetch" href="/interview_blog/assets/js/47.12709f91.js"><link rel="prefetch" href="/interview_blog/assets/js/48.d8e794b9.js"><link rel="prefetch" href="/interview_blog/assets/js/5.c38690e3.js"><link rel="prefetch" href="/interview_blog/assets/js/6.f9104e5b.js"><link rel="prefetch" href="/interview_blog/assets/js/7.397ab168.js"><link rel="prefetch" href="/interview_blog/assets/js/8.3afdacb3.js"><link rel="prefetch" href="/interview_blog/assets/js/9.a12c6f31.js">
    <link rel="stylesheet" href="/interview_blog/assets/css/0.styles.81bffcaa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/interview_blog/" class="home-link router-link-active"><!----> <span class="site-name">blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/interview_blog/" class="nav-link">
  文章目录
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/interview_blog/" class="nav-link">
  文章目录
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/interview_blog/" aria-current="page" class="sidebar-link">JavaScript</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue3 UI</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview_blog/vue3/new.html" class="sidebar-link">新特性</a></li><li><a href="/interview_blog/vue3/intro.html" aria-current="page" class="active sidebar-link">vue3 项目介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#自定义块" class="sidebar-link">自定义块</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#自定义指令" class="sidebar-link">自定义指令</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#响应式-api" class="sidebar-link">响应式 API</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#组合式-api" class="sidebar-link">组合式 API</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#内置组件" class="sidebar-link">内置组件</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#组件设计有什么原则" class="sidebar-link">组件设计有什么原则？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#细粒度的考量" class="sidebar-link">细粒度的考量</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#按需加载" class="sidebar-link">按需加载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#编写规范" class="sidebar-link">编写规范</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#webpack配置" class="sidebar-link">webpack配置</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#css-按需加载" class="sidebar-link">css 按需加载</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#gulp-vs-webpack" class="sidebar-link">gulp vs webpack</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#多种模块" class="sidebar-link">多种模块</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#自定义主题色功能" class="sidebar-link">自定义主题色功能</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#代码规范问题" class="sidebar-link">代码规范问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#eslint-代码格式规范" class="sidebar-link">ESLint 代码格式规范</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#git-hooks-commit-规范" class="sidebar-link">Git Hooks commit 规范</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#tsconfig-的配置" class="sidebar-link">tsconfig 的配置</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#自动构建命令" class="sidebar-link">自动构建命令</a></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#版本号" class="sidebar-link">版本号</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview_blog/vue3/intro.html#vue3-新特性" class="sidebar-link">vue3 新特性</a></li></ul></li><li><a href="/interview_blog/vue3/big.html" class="sidebar-link">高性能渲染十万条数据</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS 基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ajax &amp; jsonp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>函数式编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SSR</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue3-项目介绍"><a href="#vue3-项目介绍" class="header-anchor">#</a> vue3 项目介绍</h1> <h2 id="自定义块"><a href="#自定义块" class="header-anchor">#</a> <a href="https://vue-loader.vuejs.org/zh/guide/custom-blocks.html" target="_blank" rel="noopener noreferrer">自定义块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <h2 id="自定义指令"><a href="#自定义指令" class="header-anchor">#</a> 自定义指令</h2> <p>v-click-outside</p> <h2 id="响应式-api"><a href="#响应式-api" class="header-anchor">#</a> 响应式 API</h2> <p>reactive、readonly、ref、watchEffect、</p> <h2 id="组合式-api"><a href="#组合式-api" class="header-anchor">#</a> 组合式 API</h2> <p>setup
Provide / Inject
生命钩子 onX</p> <h2 id="内置组件"><a href="#内置组件" class="header-anchor">#</a> 内置组件</h2> <p>component、slot、telecport</p> <h2 id="组件设计有什么原则"><a href="#组件设计有什么原则" class="header-anchor">#</a> 组件设计有什么原则？</h2> <p><a href="https://juejin.im/post/6844903847874265101#heading-1" target="_blank" rel="noopener noreferrer">面试官(6): 写过『通用前端组件』吗?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="细粒度的考量"><a href="#细粒度的考量" class="header-anchor">#</a> 细粒度的考量</h3> <p>我们在学习设计模式的时候会遇到很多种设计原则,其中一个设计原则就是单一职责原则。
在组件库的开发中同样适用,我们原则上一个组件只专注一件事情,单一职责的组件的好处很明显,由于职责单一就可以最大可能性地复用组件,但是这也带来一个问题,过度单一职责的组件也可能会导致过度抽象,造成组件库的碎片化。</p> <p>举个例子，一个自动完成组件(AutoComplete),他其实是由 Input 组件和 Select 组件组合而成的,因此我们完全可以复用之前的相关组件,就比如 Antd 的AutoComplete组件中就复用了Select组件,同时Calendar、 Form 等等一系列组件都复用了 Select 组件,那么Select 的细粒度就是合适的,因为 Select 保持的这种细粒度很容易被复用.</p> <p>那么还有一个例子,一个徽章数组件(Badge),它的右上角会有红点提示,可能是数字也可能是 icon,他的职责当然也很单一，这个红点提示也理所当然也可以被单独抽象为一个独立组件,但是我们通常不会将他作为独立组件,因为在其他场景中这个组件是无法被复用的，因为没有类似的场景再需要小红点这个小组件了，所以作为独立组件就属于细粒度过小,因此我们往往将它作为 Badge 的内部组件,比如在 Antd 中它以ScrollNumber的名称作为Badge的内部组件存在。</p> <p>所以，所谓的单一职责组件要建立在可复用的基础上，对于不可复用的单一职责组件我们仅仅作为独立组件的内部组件即可。</p> <h1 id="通用性考量"><a href="#通用性考量" class="header-anchor">#</a> 通用性考量</h1> <h2 id="按需加载"><a href="#按需加载" class="header-anchor">#</a> 按需加载</h2> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <p>按需加载，本质上是把一个组件库的不同组件拆分成不同文件，按照需要引用对应的文件，而该文件暴露一个install方法，供Vue.use使用。</p> <p>比如：我只想引用element库里的一个Button组件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'element-ui/lib/Button.js'</span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'element-ui/lib/theme-chalk/Button.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>element</code> 使用一个了 <code>babel-plugin-component</code> 插件，作用就是代码转换：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import { Button } from 'components'

// 转换为

var button = require('components/lib/button')
require('components/lib/button/style.css')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="编写规范"><a href="#编写规范" class="header-anchor">#</a> 编写规范</h3> <p>index.js 中定义全部加载的 install 方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'./src/main'</span><span class="token punctuation">;</span>

Button<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Button<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="webpack配置"><a href="#webpack配置" class="header-anchor">#</a> webpack配置</h3> <h4 id="多入口"><a href="#多入口" class="header-anchor">#</a> 多入口</h4> <p>每个组件独立生成一个对应的js和css，这就需要我们在入口处就把组件的引用定义好：</p> <h5 id="webpack-prod-conf-js"><a href="#webpack-prod-conf-js" class="header-anchor">#</a> webpack.prod.conf.js:</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> entrys <span class="token operator">=</span> <span class="token punctuation">{</span>
    Button<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../packages/Button'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    index<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../packages'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 上述配置每增加一个组件都需要修改entrys，我们可以优化一下，使其动态生成：</span>

<span class="token keyword">const</span> entrys <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>getComponents<span class="token punctuation">.</span>js<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>组件目录入口<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> entrys<span class="token punctuation">,</span>
  <span class="token comment">// ......</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="getcomponents-js"><a href="#getcomponents-js" class="header-anchor">#</a> getComponents.js:</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 判断刚路径是否含有index.js
 * @param {String} dir 
 */</span>
<span class="token keyword">function</span> <span class="token function">hasIndexJs</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> dirs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        dirs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dirs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dirs <span class="token operator">&amp;&amp;</span> dirs<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 获取指定入口和入口下包含index.js的文件夹的路径
 * @param {String} entryDir 
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">getPath</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">entryDir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> dirs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>entryDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> entryDir
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    dirs <span class="token operator">=</span> dirs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">dir</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">hasIndexJs</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>entryDir<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dir</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">[</span>dir<span class="token punctuation">]</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>entryDir<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> getPath<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="css-按需加载"><a href="#css-按需加载" class="header-anchor">#</a> css 按需加载</h3> <p>按需打包</p> <p><img src="/interview_blog/assets/img/element-project.5ec2682e.png" alt=""> <strong>- 其实只要把packages/theme-chalk下的所有scss都编译成css就可以了</strong></p> <p><strong>- 当你需要全局引入的时候，就去引入index.scss文件，这样所有组件的样式都齐全了。</strong></p> <p><strong>- 如果你想按需引入，比如按需引入button组件，那么只要引入button.scss文件，就可以了。</strong></p> <p><strong>- 那么如何把packages/theme-chalk下的所有scss都编译成css？（Element是如何打包样式的？）</strong></p> <p><strong>- 所以ElementUI的样式打包，并不是用webpack的，是用了gulp，基于工作流去处理样式。</strong></p> <p>我们看看Element如何结合gulp去使用</p> <h3 id="gulp-vs-webpack"><a href="#gulp-vs-webpack" class="header-anchor">#</a> gulp vs webpack</h3> <ul><li><p><a href="https://github.com/Platform-CUF/use-gulp" target="_blank" rel="noopener noreferrer">gulp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 对大量源文件进行流式处理</p> <ul><li><p>易于使用：采用代码优于配置策略，gulp让简单的事情继续简单，复杂的任务变得可管理。</p></li> <li><p>高效：通过利用node.js强大的流，不需要往磁盘写中间文件，可以更快地完成构建。</p></li> <li><p>高质量：gulp严格的插件指导方针，确保插件简单并且按你期望的方式工作。</p></li> <li><p>易于学习：通过把API降到最少，你能在很短的时间内学会gulp。构建工作就像你设想的一样：是一系列流管道。</p></li></ul></li> <li><p>webpack &amp; rollup javascript模块打包方案(方案+工具+插件)，</p> <ul><li><p>webpack 为大型 SPA 而生的，模块处理路线。而如果需要将图片，样式，字体等所有静态资源全部打包</p> <ul><li>是模块化管理工具和打包工具。</li> <li>通过 loader 的转换，任何形式的资源都可以视作模块，比如 CommonJs 模块、AMD 模块、ES6 模块、CSS、图片等。它可以将许多松散的模块按照依赖和规则打包成符合生产环境部署的前端资源。还可以将按需加载的模块进行代码分隔，等到实际需要的时候再异步加载</li></ul></li> <li><p><a href="https://www.rollupjs.com/" target="_blank" rel="noopener noreferrer">rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 只做一件事，打包 js。构建一个库.</p> <ul><li>是下一代 ES6 模块化工具，它最大的亮点是利用 ES6 模块设计，生成更简洁、更简单的代码。尽可能高效地构建出能够直接被其它 JavaScript 库引用的模块</li> <li>基于权衡，Rollup 目前还不支持）和模块的热更新（HMR）</li> <li>一般而言，对于应用使用 Webpack，对于类库使用 Rollup；需要代码拆分(Code Splitting)，或者很多静态资源需要处理，再或者构建的项目需要引入很多 CommonJS 模块的依赖时，使用 webpack。代码库是基于 ES6 模块，而且希望代码能够被其他人直接使用，使用 Rollup</li> <li>Rollup 与 Webpack 有这不同的用途，因此会共同存在，并相互支持</li> <li>React 已经将构建工具从 Webpack 换成了 Rollup</li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> series<span class="token punctuation">,</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-sass'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编译gulp工具</span>
<span class="token keyword">const</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 添加厂商名字工具</span>
<span class="token keyword">const</span> cssmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-cssmin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 压缩css工具</span>

<span class="token keyword">function</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./src/*.scss'</span><span class="token punctuation">)</span> <span class="token comment">// 引入src下所有的scss样式</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sass<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 把scss文件编译成css</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 基于目标浏览器版本，添加厂商前缀</span>
      browsers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ie &gt; 9'</span><span class="token punctuation">,</span> <span class="token string">'last 2 versions'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      cascade<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 压缩css</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./lib'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出到lib下</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">copyfont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./src/fonts/**'</span><span class="token punctuation">)</span> <span class="token comment">// 读取src/fonts下的所有文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 压缩</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./lib/fonts'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出到lib/fonts下</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span>build <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>compile<span class="token punctuation">,</span> copyfont<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>最终就会帮我们打包出了样式文件。<code>gen-cssfile.js</code></p> <p>根据 <code>components.json</code>，生成 <code>package/theme-chalk/index.scss</code>，把所有组件的样式都导入到 <code>index.scss</code>
这样每次新增组件，就不用手动去引入新增组建的样式了</p> <p><code>cp-cli packages/theme-chalk/lib lib/theme-chalk</code></p> <h2 id="多种模块"><a href="#多种模块" class="header-anchor">#</a> 多种模块</h2> <ul><li><p><code>UMD</code>：<code>UMD</code> 版本可以通过 <code>&lt;script&gt;</code> 标签直接用在浏览器中。</p></li> <li><p><code>CommonJS</code>：<code>CommonJS</code> 版本用来配合老地打包工具比如 Browserify 或 webpack 1。
这些打包工具的默认文件 (pkg.main) 是只包含运行时的 CommonJS 版本 (<code>vue.runtime.common.js</code>)。</p></li> <li><p><code>ES Module</code>：从 2.6 开始 Vue 会提供两个 <code>ES Modules (ESM)</code> 构建文件：</p> <ul><li><p>为打包工具提供的 ESM：为诸如 <code>webpack 2</code> 或 <code>Rollup</code> 提供的现代打包工具。</p></li> <li><p>ESM 格式被设计为可以被静态分析，所以打包工具可以利用这一点来进行<code>“tree-shaking”</code>并将用不到的代码排除出最终的包。为这些打包工具提供的默认文件 (pkg.module) 是只有运行时的 ES Module 构建 (<code>vue.runtime.esm.js</code>)。</p></li> <li><p>为浏览器提供的 ESM (2.6+)：用于在现代浏览器中通过 <code>&lt;script type=&quot;module&quot;&gt;</code> 直接导入。</p></li></ul></li></ul> <h2 id="自定义主题色功能"><a href="#自定义主题色功能" class="header-anchor">#</a> 自定义主题色功能</h2> <p>https://juejin.im/post/6847902225377787918</p> <h2 id="代码规范问题"><a href="#代码规范问题" class="header-anchor">#</a> 代码规范问题</h2> <h3 id="eslint-代码格式规范"><a href="#eslint-代码格式规范" class="header-anchor">#</a> ESLint 代码格式规范</h3> <p>在 webpack 中配置并开启 eslint-loader 错误提示，</p> <p>基本规范是依托于 vue 官方的 eslint 规则</p> <h3 id="git-hooks-commit-规范"><a href="#git-hooks-commit-规范" class="header-anchor">#</a> Git Hooks commit 规范</h3> <h3 id="tsconfig-的配置"><a href="#tsconfig-的配置" class="header-anchor">#</a> tsconfig 的配置</h3> <h3 id="自动构建命令"><a href="#自动构建命令" class="header-anchor">#</a> 自动构建命令</h3> <p>新建文件、自动发布</p> <h4 id="新建文件"><a href="#新建文件" class="header-anchor">#</a> 新建文件</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> new <span class="token operator">&lt;</span>component-name<span class="token operator">&gt;</span> <span class="token punctuation">[</span>中文<span class="token punctuation">]</span> 这个命令
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这是用来创建一个新的组件的，然后这个命令会帮我们基于新建好的组件，帮我们进行一系列的自动化操作
当运行这个命令的时候，其实运行的是 <code>node build/bin/new.js</code></p> <p>new.js脚本主要做了下面几件事：</p> <ol><li>把你新建的组件添加到 components.json</li> <li>添加到 index.scss</li> <li>添加到 element-ui.d.ts</li> <li>创建 package</li> <li>添加到 nav.config.json</li></ol> <p>所以当我们要在 element 架构上，新建一个 elect-bill 组件
只要执行 make new elect-bill 电子账号，然后不用配置，就可以直接去开发了</p> <h4 id="自动发布"><a href="#自动发布" class="header-anchor">#</a> 自动发布</h4> <h3 id="版本号"><a href="#版本号" class="header-anchor">#</a> 版本号</h3> <p>版本号的格式为 X.Y.Z(又称 Major.Minor.Patch)，递增的规则为：</p> <ul><li>X 表示主版本号，当 API 的兼容性变化时，X 需递增。</li> <li>Y 表示次版本号，当增加功能时(不影响 API 的兼容性)，Y 需递增。</li> <li>Z 表示修订号，当做 Bug 修复时(不影响 API 的兼容性)，Z 需递增。</li></ul> <h2 id="vue3-新特性"><a href="#vue3-新特性" class="header-anchor">#</a> vue3 新特性</h2> <ul><li>proxy、首次不深拷贝</li> <li>diff 静态不 diff</li> <li>vue3 vs react 过时的闭包问题</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/11/2020, 8:21:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview_blog/vue3/new.html" class="prev">
        新特性
      </a></span> <span class="next"><a href="/interview_blog/vue3/big.html">
        高性能渲染十万条数据
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/interview_blog/assets/js/app.6e789ca6.js" defer></script><script src="/interview_blog/assets/js/2.aedcd1eb.js" defer></script><script src="/interview_blog/assets/js/10.235d3cd2.js" defer></script>
  </body>
</html>
